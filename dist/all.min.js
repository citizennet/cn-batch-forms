"use strict";!function(){angular.module("cn.batch-forms",["cn-flex-form","cn.util"])}(),function(){function e(e){function t(e,t,o){if(!o.length)return e;var c=n(e,t,o);return c.schema}function n(){return Object.create({constructor:o,processField:c,postProcessField:a,processHidden:r,processString:s,processSelect:l,getModelValues:i}).constructor()}function o(e,t,n){var o=this;return this.schema=e,this.model=t,this.models=n,e.forms?e.forms.forEach(function(e){return e.forEach(o.processField)}):e.form.forEach(this.processField),this}function c(t){if(!t.batchConfig)return void r(t);if(t.key){t.schema=t.schema||e.getSchema(t);var n=cnFlexFormTypes.getFieldType(t),o=u[n];if(!o)return void this.processHidden(t);_.isObject(t.batchConfig)||(t.batchConfig={}),t.batchConfig.ogValues=this.getModelValues(t),o.bind(this)(t),this.postProcessField(t)}else t.items&&t.items.forEach(this.processField)}function a(e){}function i(t){return this.models.map(function(n){return e.parseExpression(t.key,n).get()})}function r(e){e.condition="false"}function s(e){e.batchConfig.titleMap=e.batchConfig.titleMap||[{name:"Replace",value:"replace"},{name:"Append",value:"push"}],1===_.uniq(e.batchConfig.ogValues).length?e.placeholder=_.first(e.batchConfig.ogValues):e.placeholder="—"}function l(t){var n=this,o=t.schema.type;"array"===o?(t.batchConfig.titleMap=t.batchConfig.titleMap||[{name:"Replace",value:"replace"},{name:"Append",value:"push"},{name:"Remove",value:"remove"}],t.batchConfig.onSelect={replace:function(o){"push"!==o&&e.parseExpression(t.key,n.model).set([])},push:function(o){"replace"!==o&&e.parseExpression(t.key,n.model).set([])},remove:function(){var o=_.chain(t.batchConfig.ogValues).flatten().uniq().value();e.parseExpression(t.key,n.model).set(o)}}):(t.batchConfig.titleMap=t.batchConfig.titleMap||[{name:"Replace",value:"replace"}],t.batchConfig.onSelect={replace:function(e){var n=_.first(t.batchConfig.ogValues);_.every(t.batchConfig.ogValues,n)?t.placeholder=n[t.displayProperty||"name"]:t.placeholder="—"}}),t.batchConfig.watch={resolution:function(e,n){t.batchConfig.onSelect[e](n)}}}var u={string:s,"cn-autocomplete":l};return{augmentSchema:t}}angular.module("cn.batch-forms").factory("cnBatchForms",e),e.$inject=["cnFlexFormService"]}();
//# sourceMappingURL=all.min.js.map
